{% extends "base.html" %}

{% load staticfiles %}
{% load static %}
{% load humanize %}
{% load i18n %}

{% block extrahead %}

<link href="{% static "css/bootstrap-select.css" %}" rel="stylesheet" media="screen">

{% endblock extrahead %}


{% block webapp-menu %}
<div class="collapse navbar-collapse" id="navbar-menu">
    <ul class="nav navbar-nav">
        <li ng-class="{active: $state.includes('transactions')}"><a href="#/transactions">{% trans "Transactions" %}</a></li>
        <li ng-class="{active: $state.includes('reports')}"><a href="#/reports">{% trans "Reports" %}</a></li>
    </ul>
    <ul class="nav navbar-nav navbar-right">
        {% include "webapp/user-menu.html" %}
    </ul>
</div>
{% endblock webapp-menu %}


{% block body %}

<div class="row" ui-view role="transactions">
</div>

<script type="text/ng-template" id="transaction-list.html">
{% include "webapp/transactions/transaction-list.html" %}
</script>

<script type="text/ng-template" id="reports.html">
{% include "webapp/reports/reports.html" %}
</script>

<script type="text/ng-template" id="balance.html">
{% include "webapp/reports/balance.html" %}
</script>

<script type="text/ng-template" id="top-categories.html">
{% include "webapp/reports/top-categories.html" %}
</script>

<script type="text/ng-template" id="category-comparison.html">
{% include "webapp/reports/category-comparison.html" %}
</script>

{% if FIRST_LOGIN %}
    {% if USE_GA %}
        {% include "ga_first_login_snippet.html" %}
    {% endif %}
{% endif %}

{% endblock body %}


{% block bodyend %}

{% if is_debug %}

    {% comment %}
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular-resource.js"></script>
    {% endcomment %}

    {% get_static_prefix as static_path %}

    {% with app=static_path|add:"js/app/" controllers=static_path|add:"js/app/controllers/" lib=static_path|add:"js/lib/" locales=static_path|add:"js/locales/" %}

        <script src="{{lib}}min/angular.min.js"></script>
        <script src="{{lib}}min/angular-resource.min.js"></script>
        <script src="{{lib}}angular-strap.js"></script>
        <script src="{{lib}}min/angular-ui-router.min.js"></script>
        <script src="{{lib}}highcharts.src.js"></script>
        <script src="{{lib}}bootstrap-datepicker.js"></script>
        <script src="{{lib}}jquery.maskMoney.js"></script>
        <script src="{{lib}}toastr.js"></script>
        <script src="{{lib}}min/moment.min.js"></script>
        <script src="{{lib}}bootstrap-select.js"></script>
        <script src="{{lib}}min/modernizr.custom.19405.js"></script>

        <script src="{{locales}}angular-locale_pt-br.js"></script>
        <script src="{{locales}}bootstrap-datepicker.pt-BR.js"></script>
        <script src="{{locales}}pt-br.js"></script>

        <script src="{{app}}app.js"></script>
        <script src="{{controllers}}balance-panel-ctrl.js"></script>
        <script src="{{controllers}}transaction-action-bar-ctrl.js"></script>
        <script src="{{controllers}}transaction-form-ctrl.js"></script>
        <script src="{{controllers}}transaction-list-ctrl.js"></script>
        <script src="{{controllers}}category-list-ctrl.js"></script>
        <script src="{{controllers}}category-edit-ctrl.js"></script>
        <script src="{{controllers}}reports-ctrl.js"></script>

        <script src="{{app}}services.js"></script>
        <script src="{{app}}modules/charts.js"></script>
        <script src="{{app}}modules/models.js"></script>
        <script src="{{app}}modules/ga.js"></script>
        <script src="{{app}}modules/hashtags.js"></script>

        <script src="{{app}}directives.js"></script>

    {% endwith %}

{% else %}

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.3/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.3/angular-resource.min.js"></script>

    <script src="{% static "js/webapp.min.js" %}"></script>

{% endif %}

{% if FIRST_LOGIN %}
    <script type="text/javascript">
        window.isUserFirstLogin = true;
        $(function () {
            toastr.info("{% trans "Welcome to Niqels, {0}!"%}".format('{{ user.name }}'), null, {positionClass: "toast-bottom-full-width"});
        });
    </script>
{% endif %}

{% endblock bodyend %}
