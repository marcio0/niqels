{% load i18n %}

<h4 class="area-header">{% trans "New transaction" %}</h4>

<div ng-controller="TransactionFormCtrl" class="">
<form
    class="transaction-form"
    name="transactionForm"
    method="post"
    id="transaction-form"

    novalidate
    >

    <div class="form-group input-icon">
        <label for="id_category" class="form-label">{% trans "Category" %}</label>
        <i class="fa fa-tag input-icon-prepend"></i>
        <select
            id="id_category"
            name="category"
            class="form-control"

            ng-model="formData.category"
            category-field
            data-live-search="true"

            required

            ng-options="c.resource_uri as c.name group by c.group for c in categories"
            >
        </select>
        <i
            class="fa fa-exclamation fa-lg input-icon-append input-error"
            ng-show="transactionForm.category.$error.required && transactionForm.category.$dirty"
            ></i>
    </div>

    <div class="form-group input-icon animate-show animate-show-normal" ng-hide="is_installment">
        <label for="id_value" class="form-label">{% trans "Value" %}</label>
        <i class="fa fa-dollar input-icon-prepend"></i>
        <input
            id="id_value"
            name="value"
            class="form-control"

            ng-model="formData.value"
            value-field

            required

            autocomplete="off"
            />
    </div>

    <div ng-show="is_installment" ng-controller="InstallmentFormCtrl" class="animate-show animate-show-tall" ng-form="installment-form">
        <div class="form-group input-icon">
            <label for="id_value" class="form-label">{% trans "Installment value" %}</label>
            <i class="fa fa-dollar input-icon-prepend"></i>
            <input
                id="id_value"
                name="value"
                class="form-control"

                ng-model="installment.installmentValue"
                ng-required="is_installment"
                ng-change="updateInstallmentValue()"
                value-field

                autocomplete="off"
                />
        </div>
        <div class="form-group input-icon">
            <label for="id_total_value" class="form-label">{% trans "Total value" %}</label>
            <i class="fa fa-dollar input-icon-prepend"></i>
            <input
                id="id_total_value"
                name="total-value"
                class="form-control"

                ng-model="installment.totalValue"
                ng-change="updateTotalValue()"
                value-field

                ng-required="is_installment"

                autocomplete="off"
                />
        </div>
        <div class="form-group input-icon">
            <label for="id_qty_installments" class="form-label">{% trans "Number of installments" %}</label>
            <i class="fa fa-calendar-o input-icon-prepend"></i>
            <input
                id="id_qty_installments"
                name="qty-installments"
                class="form-control"
                type="number"
                min="1"

                ng-model="installment.qtyInstallments"
                ng-required="is_installment"
                ng-pattern="/\d+/"
                ng-change="updateQtyInstallments()"

                autocomplete="off"
                />
        </div>
    </div>

    <div class="checkbox">
        <input
            type="checkbox"
            ng-model="is_installment"
            ng-false-value="false"
            ng-true-value="true"
            ng-change="selectInstallment()"
            >{% trans "This is an installment purchase" %}
    </div>

    <div class="form-group input-icon">
        <label for="id_description" class="form-label">{% trans "Description" %}</label>
        <i class="fa fa-pencil input-icon-prepend"></i>
        <input
            id="id_description"
            maxlength="200"
            name="description"
            type="text"
            class="form-control"

            ng-model="formData.description"

            placeholder="{% trans "Example: &quot;Lunch with friends&quot;" %}"
            autocomplete="off"
            />
    </div>

    <div class="form-group input-icon">
        <label for="id_date" class="form-label">{% trans "Date" %}</label>
        <div
            date-field
            date-field-model="formData.date"
            id="id_date"
            name="date"

        ></div>
    </div>

    <button ng-click="submit()" class="btn btn-block btn-primary" ng-disabled="sending">
    {% trans "Submit" %}
    <i ng-show="sending" class="fa fa-spinner fa-spin fa-lg"></i>
    <i ng-hide="sending" class="fa fa-check fa-lg"></i>
    </button>
</form>


</div>
